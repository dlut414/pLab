'use strict';function setup(a){this.header=new DataView(a,0,54),this.width=header.getInt32(18,!0),this.height=header.getInt32(22,!0),this.rowSize=-4&3*this.width+3,this.data=[];for(var c=0;c<this.height;c++)for(var d=54+c*this.rowSize,e=new DataView(a,d,this.rowSize),f=0;f<this.width;f++){var h=e.getUint8(3*f),k=e.getUint8(3*f+1),l=e.getUint8(3*f+2);this.data.push(((0|l)<<16)+((0|k)<<8)+(0|h))}}function make(color2type,color2vel){for(var output='',dp=+$('#point_distance').val(),i=0;i<this.height;i++)for(var id,j=0;j<this.width;j++)if(id=i*this.width+j,color2type.has(this.data[id])){var type=color2type.get(this.data[id]),x=j*dp,y=i*dp,vx=0,vy=0;color2vel.has(this.data[id])?(vx=eval(color2vel.get(this.data[id])[0]),vy=eval(color2vel.get(this.data[id])[1]),vx=vx?vx:0,vy=vy?vy:0):vx=vy=0;for(var line=type+' '+x.toExponential(6)+' '+y.toExponential(6)+' '+vx.toExponential(6)+' '+vy.toExponential(6),p=0;p<$('#trailing_zero').val();p++)line+=' 0';line+='\r\n',output+=line}download('output.txt',output)}function download(a,c){var d=new Blob([c],{type:'text/plain'}),e=document.createElement('a');e.setAttribute('href',window.URL.createObjectURL(d)),e.setAttribute('download',a),e.style.display='none',document.body.appendChild(e),e.click(),document.body.removeChild(e)}$('#button-save').click(function(){var h=this,a=[],c=[];if($('.color').each(function(){a.push(parseInt($(this).val().substr(-6),16))}),$('.type').each(function(){c.push($(this).val())}),a.length!=c.length)return void alert('Length of color is different from length of type');this.color2type=new Map,a.forEach(function(k,l){return h.color2type.set(k,c[l])});var d=[],e=[],f=[];$('.color-vel').each(function(){d.push(parseInt($(this).val().substr(-6),16))}),$('.string-vx').each(function(){e.push($(this).val())}),$('.string-vy').each(function(){f.push($(this).val())}),this.color2vel=new Map,d.forEach(function(k,l){return h.color2vel.set(k,[e[l],f[l]])}),make(this.color2type,this.color2vel)});